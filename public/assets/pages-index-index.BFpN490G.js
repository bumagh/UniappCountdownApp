import{_ as a,c as t,w as e,n as l,i as s,o as n,a as o,b as d,d as c,e as u,t as r,S as i,f as y,F as f,r as g,g as w,h as C}from"./index-sFHZ-OT3.js";import{d as _}from"./db.Cc0ive14.js";const p=a({name:"Index",components:{},data:()=>({user:{id:1,nickname:"å¼ ä¸‰"},allCountdowns:[],categories:[],drawerVisible:!1}),computed:{countdownsWithDisplayDate(){return this.allCountdowns.map(a=>{let t=a.date;return a.repeatCycle>0&&"ä¸é‡å¤"!==a.repeatFrequency&&(t=_.getNextRepeatDate(a.date,a.repeatCycle,a.repeatFrequency)),{...a,displayDate:t}})},pinnedCountdowns(){return this.countdownsWithDisplayDate.filter(a=>a.isPinned).sort((a,t)=>new Date(t.updatedAt)-new Date(a.updatedAt))},futureCountdowns(){return this.countdownsWithDisplayDate.filter(a=>_.calculateDays(a.displayDate)>=0).sort((a,t)=>_.calculateDays(a.displayDate)-_.calculateDays(t.displayDate))},pastCountdowns(){return this.countdownsWithDisplayDate.filter(a=>_.calculateDays(a.displayDate)<0).sort((a,t)=>_.calculateDays(t.displayDate)-_.calculateDays(a.displayDate))}},onShow(){this.loadData()},methods:{loadData(){const a=_.getCurrentUser();a&&(this.user=a,this.allCountdowns=_.getCountdowns(a.id),this.categories=_.getCategories(a.id))},calculateDays:a=>_.calculateDays(a),getAbsoluteDays:a=>Math.abs(_.calculateDays(a)),formatDate:a=>_.formatDate(a),getCategoryColor(a){const t=this.categories.find(t=>t.id===a);return t?t.color:"#1890ff"},getCategoryName(a){const t=this.categories.find(t=>t.id===a);return t?t.name:"æœªåˆ†ç±»"},getCategoryCount(a){return this.allCountdowns.filter(t=>t.categoryId===a).length},toggleDrawer(){this.drawerVisible=!this.drawerVisible},showAddCountdown(){l({url:"/pages/edit/edit"})},handleCountdownClick(a){l({url:`/pages/detail/detail?id=${a.id}`})},handleAllCategory(){this.drawerVisible=!1},handleCategoryClick(a){this.drawerVisible=!1,l({url:`/pages/categories/categories?categoryId=${a.id}`})}}},[["render",function(a,l,_,p,D,h){const k=c,m=s,b=i;return n(),t(m,{class:"page-container"},{default:e(()=>[o(m,{class:"navbar"},{default:e(()=>[o(m,{class:"navbar-icon",onClick:h.toggleDrawer},{default:e(()=>[o(k,null,{default:e(()=>[u("â˜°")]),_:1})]),_:1},8,["onClick"]),o(m,{class:"navbar-title"},{default:e(()=>[o(k,null,{default:e(()=>[u(r(D.user.nickname)+"çš„å€’æ•°æ—¥",1)]),_:1})]),_:1}),o(m,{class:"navbar-icon",onClick:h.showAddCountdown},{default:e(()=>[o(k,null,{default:e(()=>[u("+")]),_:1})]),_:1},8,["onClick"])]),_:1}),o(b,{"scroll-y":"",class:"page-content"},{default:e(()=>[h.pinnedCountdowns.length>0?(n(),t(m,{key:0,class:"countdown-section"},{default:e(()=>[o(m,{class:"section-header"},{default:e(()=>[o(k,{class:"section-title"},{default:e(()=>[u("ç½®é¡¶")]),_:1}),o(k,{class:"section-count"},{default:e(()=>[u(r(h.pinnedCountdowns.length)+"ä¸ª",1)]),_:1})]),_:1}),(n(!0),y(f,null,g(h.pinnedCountdowns,a=>(n(),t(m,{key:a.id,class:w(["countdown-card shadow pinned-card",{"past-card":h.calculateDays(a.displayDate)<0}]),onClick:t=>h.handleCountdownClick(a)},{default:e(()=>[o(m,{class:"pin-badge"},{default:e(()=>[o(k,null,{default:e(()=>[u("ðŸ“Œ")]),_:1})]),_:1}),o(m,{class:w(["countdown-main",{"past-main":h.calculateDays(a.displayDate)<0}])},{default:e(()=>[o(k,{class:"countdown-number"},{default:e(()=>[u(r(h.getAbsoluteDays(a.displayDate)),1)]),_:2},1024),o(k,{class:"countdown-unit"},{default:e(()=>[u("å¤©")]),_:1})]),_:2},1032,["class"]),o(m,{class:"countdown-info"},{default:e(()=>[o(k,{class:"countdown-title"},{default:e(()=>[u(r(a.title),1)]),_:2},1024),o(k,{class:"countdown-date"},{default:e(()=>[u(r(h.formatDate(a.displayDate)),1)]),_:2},1024),o(m,{class:"countdown-category"},{default:e(()=>[o(m,{class:"category-dot",style:C({backgroundColor:h.getCategoryColor(a.categoryId)})},null,8,["style"]),o(k,{class:"category-name"},{default:e(()=>[u(r(h.getCategoryName(a.categoryId)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})):d("",!0),h.futureCountdowns.length>0?(n(),t(m,{key:1,class:"countdown-section"},{default:e(()=>[o(m,{class:"section-header"},{default:e(()=>[o(k,{class:"section-title"},{default:e(()=>[u("æœªæ¥")]),_:1}),o(k,{class:"section-count"},{default:e(()=>[u(r(h.futureCountdowns.length)+"ä¸ª",1)]),_:1})]),_:1}),(n(!0),y(f,null,g(h.futureCountdowns,a=>(n(),t(m,{key:a.id,class:w(["countdown-card shadow",{"pinned-card":a.isPinned,"past-card":h.calculateDays(a.displayDate)<0}]),onClick:t=>h.handleCountdownClick(a)},{default:e(()=>[a.isPinned?(n(),t(m,{key:0,class:"pin-badge"},{default:e(()=>[o(k,null,{default:e(()=>[u("ðŸ“Œ")]),_:1})]),_:1})):d("",!0),o(m,{class:w(["countdown-main",{"past-main":h.calculateDays(a.displayDate)<0}])},{default:e(()=>[o(k,{class:"countdown-number"},{default:e(()=>[u(r(h.getAbsoluteDays(a.displayDate)),1)]),_:2},1024),o(k,{class:"countdown-unit"},{default:e(()=>[u("å¤©")]),_:1})]),_:2},1032,["class"]),o(m,{class:"countdown-info"},{default:e(()=>[o(k,{class:"countdown-title"},{default:e(()=>[u(r(a.title),1)]),_:2},1024),o(k,{class:"countdown-date"},{default:e(()=>[u(r(h.formatDate(a.displayDate)),1)]),_:2},1024),o(m,{class:"countdown-category"},{default:e(()=>[o(m,{class:"category-dot",style:C({backgroundColor:h.getCategoryColor(a.categoryId)})},null,8,["style"]),o(k,{class:"category-name"},{default:e(()=>[u(r(h.getCategoryName(a.categoryId)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})):d("",!0),h.pastCountdowns.length>0?(n(),t(m,{key:2,class:"countdown-section"},{default:e(()=>[o(m,{class:"section-header"},{default:e(()=>[o(k,{class:"section-title"},{default:e(()=>[u("å·²ç»")]),_:1}),o(k,{class:"section-count"},{default:e(()=>[u(r(h.pastCountdowns.length)+"ä¸ª",1)]),_:1})]),_:1}),(n(!0),y(f,null,g(h.pastCountdowns,a=>(n(),t(m,{key:a.id,class:w(["countdown-card shadow past-card",{"pinned-card":a.isPinned}]),onClick:t=>h.handleCountdownClick(a)},{default:e(()=>[a.isPinned?(n(),t(m,{key:0,class:"pin-badge"},{default:e(()=>[o(k,null,{default:e(()=>[u("ðŸ“Œ")]),_:1})]),_:1})):d("",!0),o(m,{class:"countdown-main past-main"},{default:e(()=>[o(k,{class:"countdown-number"},{default:e(()=>[u(r(h.getAbsoluteDays(a.displayDate)),1)]),_:2},1024),o(k,{class:"countdown-unit"},{default:e(()=>[u("å¤©")]),_:1})]),_:2},1024),o(m,{class:"countdown-info"},{default:e(()=>[o(k,{class:"countdown-title"},{default:e(()=>[u(r(a.title),1)]),_:2},1024),o(k,{class:"countdown-date"},{default:e(()=>[u(r(h.formatDate(a.displayDate)),1)]),_:2},1024),o(m,{class:"countdown-category"},{default:e(()=>[o(m,{class:"category-dot",style:C({backgroundColor:h.getCategoryColor(a.categoryId)})},null,8,["style"]),o(k,{class:"category-name"},{default:e(()=>[u(r(h.getCategoryName(a.categoryId)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})):d("",!0),0===D.allCountdowns.length?(n(),t(m,{key:3,class:"empty-state"},{default:e(()=>[o(k,{class:"empty-icon"},{default:e(()=>[u("ðŸ“…")]),_:1}),o(k,{class:"empty-text"},{default:e(()=>[u("è¿˜æ²¡æœ‰å€’æ•°æ—¥")]),_:1}),o(m,{class:"btn btn-primary",onClick:h.showAddCountdown},{default:e(()=>[o(k,null,{default:e(()=>[u("æ·»åŠ ç¬¬ä¸€ä¸ªå€’æ•°æ—¥")]),_:1})]),_:1},8,["onClick"])]),_:1})):d("",!0),o(m,{style:{height:"40rpx"}})]),_:1}),D.drawerVisible?(n(),t(m,{key:0,class:"drawer-mask",onClick:h.toggleDrawer},null,8,["onClick"])):d("",!0),o(m,{class:w(["drawer",{"drawer-open":D.drawerVisible}])},{default:e(()=>[o(m,{class:"drawer-header"},{default:e(()=>[o(k,{class:"drawer-title"},{default:e(()=>[u("å€’æ•°æœ¬")]),_:1}),o(m,{class:"drawer-close",onClick:h.toggleDrawer},{default:e(()=>[o(k,null,{default:e(()=>[u("âœ•")]),_:1})]),_:1},8,["onClick"])]),_:1}),o(b,{"scroll-y":"",class:"drawer-content"},{default:e(()=>[o(m,{class:"category-list"},{default:e(()=>[o(m,{class:"category-drawer-item",onClick:h.handleAllCategory},{default:e(()=>[o(m,{class:"category-drawer-icon",style:{"background-color":"#1890ff"}},{default:e(()=>[o(k,null,{default:e(()=>[u("ðŸ“‹")]),_:1})]),_:1}),o(k,{class:"category-drawer-name"},{default:e(()=>[u("å…¨éƒ¨")]),_:1}),o(k,{class:"category-drawer-count"},{default:e(()=>[u(r(D.allCountdowns.length),1)]),_:1})]),_:1},8,["onClick"]),(n(!0),y(f,null,g(D.categories,a=>(n(),t(m,{key:a.id,class:"category-drawer-item",onClick:t=>h.handleCategoryClick(a)},{default:e(()=>[o(m,{class:"category-drawer-icon",style:C({backgroundColor:a.color})},{default:e(()=>[o(k,null,{default:e(()=>[u(r(a.icon),1)]),_:2},1024)]),_:2},1032,["style"]),o(k,{class:"category-drawer-name"},{default:e(()=>[u(r(a.name),1)]),_:2},1024),o(k,{class:"category-drawer-count"},{default:e(()=>[u(r(h.getCategoryCount(a.id)),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1},8,["class"])]),_:1})}],["__scopeId","data-v-03b40b87"]]);export{p as default};
