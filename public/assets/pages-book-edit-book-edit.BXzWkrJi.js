import{_ as a,c as t,w as e,s as o,k as l,D as s,i as c,o as i,a as n,d as r,e as d,t as f,S as m,b as u,I as h,f as _,F as b,r as g,g as k,h as D}from"./index-sFHZ-OT3.js";import{d as y}from"./db.Cc0ive14.js";const C=a({name:"BookEdit",data:()=>({categoryId:null,isEdit:!1,formData:{name:"",icon:"ðŸ ",color:"#ff6b9d"},iconList:["ðŸ ","ðŸ’¼","ðŸ‘¨â€ðŸ‘©â€ðŸ‘§","ðŸŽ¯","â¤ï¸","ðŸŽ‰","ðŸ“š","âœˆï¸","ðŸŽ‚","ðŸ’ª","ðŸŽ¨","ðŸŽµ","âš½","ðŸ”","ðŸŒŸ","ðŸ”¥","ðŸ’¡","ðŸŒˆ"],colorList:["#ff6b9d","#1cbbb4","#fbbd08","#39b54a","#e54d42","#8799a3","#a463f2","#ff9500","#0081ff","#6739b6","#1cbbb4","#f37b1d"]}),onLoad(a){a.id&&(this.categoryId=parseInt(a.id),this.isEdit=!0,this.loadCategoryData())},methods:{loadCategoryData(){const a=y.getCategory(this.categoryId);a&&(this.formData={name:a.name,icon:a.icon,color:a.color})},selectIcon(a){this.formData.icon=a},selectColor(a){this.formData.color=a},goBack(){s({delta:1})},handleDelete(){this.isEdit&&l({title:"ç¡®è®¤åˆ é™¤",content:`ç¡®å®šè¦åˆ é™¤"${this.formData.name}"å€’æ•°æœ¬å—ï¼Ÿè¯¥åˆ†ç±»ä¸‹çš„å€’æ•°æ—¥ä¹Ÿä¼šè¢«åˆ é™¤ã€‚`,confirmColor:"#e54d42",success:a=>{if(a.confirm)try{y.deleteCategory(this.categoryId),o({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),setTimeout(()=>{this.goBack()},1e3)}catch(t){o({title:"åˆ é™¤å¤±è´¥",icon:"none"})}}})},handleSubmit(){if(!this.formData.name.trim())return void o({title:"è¯·è¾“å…¥æœ¬å­åç§°",icon:"none"});const a=y.getCurrentUser();if(a)try{this.isEdit?(y.updateCategory(this.categoryId,{name:this.formData.name,icon:this.formData.icon,color:this.formData.color}),o({title:"ä¿®æ”¹æˆåŠŸ",icon:"success"})):(y.addCategory({name:this.formData.name,icon:this.formData.icon,color:this.formData.color,userId:a.id}),o({title:"æ·»åŠ æˆåŠŸ",icon:"success"})),setTimeout(()=>{this.goBack()},1e3)}catch(t){o({title:"æ“ä½œå¤±è´¥",icon:"none"})}else o({title:"ç”¨æˆ·ä¿¡æ¯èŽ·å–å¤±è´¥",icon:"none"})}}},[["render",function(a,o,l,s,y,C){const p=r,I=c,v=h,E=m;return i(),t(I,{class:"page-container"},{default:e(()=>[n(I,{class:"navbar"},{default:e(()=>[n(I,{class:"navbar-icon",onClick:C.goBack},{default:e(()=>[n(p,null,{default:e(()=>[d("â€¹")]),_:1})]),_:1},8,["onClick"]),n(I,{class:"navbar-title"},{default:e(()=>[n(p,null,{default:e(()=>[d(f(y.isEdit?"ç¼–è¾‘å€’æ•°æœ¬":"æ·»åŠ å€’æ•°æœ¬"),1)]),_:1})]),_:1}),n(I,{class:"navbar-icon",onClick:C.handleSubmit},{default:e(()=>[n(p,null,{default:e(()=>[d("âœ“")]),_:1})]),_:1},8,["onClick"])]),_:1}),n(E,{"scroll-y":"",class:"page-content"},{default:e(()=>[n(I,{class:"form-container"},{default:e(()=>[n(I,{class:"form-item"},{default:e(()=>[n(p,{class:"form-label"},{default:e(()=>[d("æœ¬å­åç§°")]),_:1}),n(v,{class:"form-input",modelValue:y.formData.name,"onUpdate:modelValue":o[0]||(o[0]=a=>y.formData.name=a),placeholder:"è¯·è¾“å…¥æœ¬å­åç§°",maxlength:"10"},null,8,["modelValue"])]),_:1}),n(I,{class:"form-item"},{default:e(()=>[n(p,{class:"form-label"},{default:e(()=>[d("é€‰æ‹©å›¾æ ‡")]),_:1}),n(I,{class:"icon-grid"},{default:e(()=>[(i(!0),_(b,null,g(y.iconList,(a,o)=>(i(),t(I,{key:o,class:k(["icon-item",{"icon-active":y.formData.icon===a}]),onClick:t=>C.selectIcon(a)},{default:e(()=>[n(p,{class:"icon-text"},{default:e(()=>[d(f(a),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1}),n(I,{class:"form-item"},{default:e(()=>[n(p,{class:"form-label"},{default:e(()=>[d("é€‰æ‹©é¢œè‰²")]),_:1}),n(I,{class:"color-grid"},{default:e(()=>[(i(!0),_(b,null,g(y.colorList,(a,o)=>(i(),t(I,{key:o,class:k(["color-item",{"color-active":y.formData.color===a}]),style:D({backgroundColor:a}),onClick:t=>C.selectColor(a)},{default:e(()=>[y.formData.color===a?(i(),t(p,{key:0,class:"color-check"},{default:e(()=>[d("âœ“")]),_:1})):u("",!0)]),_:2},1032,["class","style","onClick"]))),128))]),_:1})]),_:1})]),_:1}),y.isEdit?(i(),t(I,{key:0,class:"delete-section"},{default:e(()=>[n(I,{class:"btn btn-danger",onClick:C.handleDelete},{default:e(()=>[n(p,null,{default:e(()=>[d("åˆ é™¤å€’æ•°æœ¬")]),_:1})]),_:1},8,["onClick"])]),_:1})):u("",!0),n(I,{style:{height:"40rpx"}})]),_:1})]),_:1})}],["__scopeId","data-v-17e28d43"]]);export{C as default};
